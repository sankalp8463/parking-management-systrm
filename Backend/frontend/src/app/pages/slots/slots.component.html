<div class="slots-page">
  <div class="container">
    <h1>Parking Slot Management</h1> 
    <p></p>

    <!-- Top Bar -->
    <div class="top-bar">
      <h3>All Slots</h3>
      <select [(ngModel)]="filterType" class="type-select">
        <option value="">All Types</option>
        <option value="bike">Bike</option>
        <option value="car">Car</option>
        <option value="truck">Truck</option>
      </select>

      <button class="add-slot-dd" (click)="openAddModal()"><b>Add Slot ▾</b></button>
    </div>

    <!-- All slots preview - FIXED: Show actual slot numbers -->
    <div class="all-slot-preview">
      <div
        class="preview-item"
        *ngFor="let slot of getSortedFilteredSlots()"
        [ngClass]="slot.status"
        (click)="selectSlot(slot)"
      >
      {{ slot.slotNumber }}
      </div>
    </div>

    

    <!-- Floor Layout -->
    <h2>Slot Layout</h2>
    <div class="floors-layout">
      <div class="floor-column" *ngFor="let fl of floors">
        <h3>{{ fl.label }}</h3>
        <div class="slot-matrix">
          <div class="slot-matrix">

            <!-- Bikes (A..D) -->
            <ng-container *ngIf="fl.type=='bike'">
              <div *ngFor="let r of rows" class="slot-row">
                <div *ngFor="let c of cols" class="slot-box"
                     [ngClass]="getSlotClass(r+c, fl.type)"
                     (click)="selectSlotFromMatrix(r+c, fl.type)">
                  {{ r + c }}
                </div>
              </div>
            </ng-container>
          
            <!-- Cars (E..H) -->
            <ng-container *ngIf="fl.type=='car'">
              <div *ngFor="let r of rows" class="slot-row">
                <div *ngFor="let c of cols" class="slot-box"
                     [ngClass]="getSlotClass(toChar(r,4)+c, fl.type)"
                     (click)="selectSlotFromMatrix(toChar(r,4)+c, fl.type)">
                  {{ toChar(r,4) + c }}
                </div>
              </div>
            </ng-container>
          
            <!-- Trucks (L..O) -->
            <ng-container *ngIf="fl.type=='truck'">
              <div *ngFor="let r of rows" class="slot-row">
                <div *ngFor="let c of cols" class="slot-box"
                     [ngClass]="getSlotClass(toChar(r,10)+c, fl.type)"
                     (click)="selectSlotFromMatrix(toChar(r,10)+c, fl.type)">
                  {{ toChar(r,10) + c }}
                </div>
              </div>
            </ng-container>
          
          </div>
          
        </div>
      </div>
    </div>
<!-- Statistic -->
<div class="slots-overview">
  <h2>Slot Statistics</h2>
  <div class="stats-grid">
    <div class="stat-card available">
      <h3>Available</h3>
      <p class="stat-number">{{ slotStats.available }}</p>
    </div>
    <div class="stat-card occupied">
      <h3>Occupied</h3>
      <p class="stat-number">{{ slotStats.occupied }}</p>
    </div>
    <div class="stat-card maintenance">
      <h3>Maintenance</h3>
      <p class="stat-number">{{ slotStats.maintenance }}</p>
    </div>
    <div class="stat-card total">
      <h3>Total Slots</h3>
      <p class="stat-number">{{ slotStats.total }}</p>
    </div>
  </div>
</div>
    <!-- Table -->
    <div class="slots-table">
      <h2>All Parking Slots</h2>
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Slot Number</th>
              <th>Vehicle Type</th>
              <th>Hourly Rate</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let slot of slots">
              <td>{{ slot.slotNumber }}</td>

              <td>{{ slot.vehicleType }}</td>
              <td>₹{{ slot.hourlyRate }}</td>
              <td>
                <span class="status-badge" [ngClass]="slot.status">{{ slot.status }}</span>
              </td>
              <td>
                <button class="btn-edit" (click)="editSlot(slot)">Edit</button>
                <button class="btn-delete" (click)="deleteSlot(slot._id)">Delete</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Add Slot Modal -->
    <div class="modal" *ngIf="showAddModal" (click)="closeAddModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <h3>Add New Parking Slot</h3>
        <form (ngSubmit)="addSlot()" #slotForm="ngForm">
          <div class="form-group">
            <label>Vehicle Type</label>
            <select [(ngModel)]="newSlot.vehicleType" name="vehicleType" required>
              <option value="bike">Bike</option>
              <option value="car">Car</option>
              <option value="truck">Truck</option>
            </select>
          </div>
          <div class="form-group">
            <label>Slot Number</label>
            <input type="text" [(ngModel)]="newSlot.slotNumber" name="slotNumber" required />
          </div>
          <div class="form-group">
            <label>Hourly Rate</label>
            <input type="number" [(ngModel)]="newSlot.hourlyRate" name="hourlyRate" required />
          </div>
          <div class="form-group">
            <label>Status</label>
            <select [(ngModel)]="newSlot.status" name="status" required>
              <option value="available">Available</option>
              <option value="occupied">Occupied</option>
              <option value="maintenance">Maintenance</option>
            </select>
          </div>
          <div class="modal-actions">
            <button class="btn-primary" type="submit" [disabled]="!slotForm.valid"><b>Add Slot</b></button>
            <button class="btn-secondary" type="button" (click)="closeAddModal()"><b>Cancel</b></button>
          </div>
        </form>
      </div>
    </div>

  </div>
</div>